<!-- This page is built to help facilitate the creation of GXL node building-->
<!-- mostly built with GitHub Copilot -->

<html>
  <head>
    <meta charset="utf-8">
    <title>GXL Node Builder</title>

    <!-- <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"></script> -->

    
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script> -->

    <style>
      body {
        padding-top: 2%;
        padding-bottom: 3%;
        background-color: #1aa890;
        font: 400 15px Lato, sans-serif;
      }

      h1 {
        color: #fff;
        text-transform: uppercase;
        font-weight: 300;
        text-align: center;
        margin: 0 0 20px 0;
        letter-spacing: 4px;
      }

      h2 {
        color: #fff;
        text-transform: uppercase;
        font-weight: 300;
        text-align: left;
        margin: 0 0 20px 0;
      }
/* 
      .form-control {
        min-height: 21px;
        background: #fff;
        box-shadow: none !important;
        border-color: #e3e3e3;
      } */

      label {
        text-align: left !important;
        margin-bottom: 0;
      }

      /* https://github.com/solodev/hide-show-fields-form */
      form {
        max-width: 900px;
        display: block;
        margin: 0 auto;
      }

    </style>
  </head>

  <script>
    function getGraphElementValue(node) {
      var node = document.getElementById(node);
      return node.value;
    }
    
    function getGraphElementValueArray(node) {
      var nodeValues;
      for(var index=0; index < node.length; index++) {
        var node = document.getElementById(node[index]);

        //if not last index
        if(index != node.length-1) {
          nodeValues += node.value + ",";
        } else {
          nodeValues += node.value;
        }
        
      }
      
      return nodeValues;
    }

    function createNode(graphElementType, graphElementName, nodeValue, nodeText, edgeSource, edgeTarget) {
      // var node = document.createElement(graphElementType);
      // node.setAttribute("id", graphElementName);
      // node.setAttribute("value", nodeValue);
      // node.innerText = nodeText;

//    <edge id="Link Dark Wanderer to Diablo" source="1" target="0"/>
//    <node id="boss_04_Diablo"> 

      var nodeString = document.getElementById("currentNodeString");

      if (graphElementType.toLowerCase() == "node"){
        nodeString.textContent = "<node id=\""+graphElementName+"\">\n";
        nodeString.textContent += "\n\t\</node\> \n\n";

      } else {
        nodeString.textContent = "<edge id=\""+graphElementName+"\" source=\""+ edgeSource +"\" target=\""+ edgeTarget +"\"/>";
      }

      // "\n\t\t" + graphElementName
      // + "\n\t\t" + nodeValue
      // + "\n\t\t" + nodeText
      // + "\n\t\</" + graphElementType + "\>"


      nodeString.innerHTML = nodeString.innerHTML.replace(/\n\r?/g, '<br />');
      // "\</node\>";//node.outerHTML;


      return node;
    }

    function addTextToScratchPad() {
      var ScratchPad =document.getElementById("ScratchPad");
      var nodeString = document.getElementById("currentNodeString");

      ScratchPad.innerHTML += nodeString.innerHTML + " \n";
      ScratchPad.innerHTML = ScratchPad.innerHTML.replace(/\n\r?/g, '<br />');
    }
  </script>



<body>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1>GXL Node Builder</h1>

        <h2>Create a new Node or Edge</h2>
        <div class="row">
          <div class="col-md-12">
            <!--input field that updates a div on keyup-->
            <div class="form-group" onchange="createNode(getGraphElementValue('graphElementType'), 
                                                         getGraphElementValue('graphElementName'), 
                                                         getGraphElementValueArray(fieldNodeKeyVal), 
                                                         getGraphElementValueArray(fieldNodeDataVal), 
                                                         getGraphElementValue('fieldEdgeSource'), 
                                                         getGraphElementValue('fieldEdgeTarget'))">
              <!--  Aligned label column and input column-->

              <label for="graphElementName">Element Name: </label>
              <input type="text" class="form-control" id="graphElementName" placeholder="the 'id' value">

              <!-- Add blank space to form -->
              <pre></pre>  
            
              <!-- NOW AT: https://github.com/ActuallyFro/hide-show-fields-form -->
              <div class="form-group">
                <label for="graphElementType">Graph Element Type</label>
                <select class="form-control" id="graphElementType">
                  <option value="node">node</option>
                  <option value="edge">edge</option>
                </select>
              </div>

              <div class="form-group" id="fieldEdgeDivGroup">
                <div class="row">
                  <div class="col-6">
                    <label for="fieldEdgeSource">Source</label>
                    <input type="text" class="form-control w-100" id="fieldEdgeSource" placeholder="the 'id' for source">
                  </div>
                  <div class="col-6">
                    <label for="fieldEdgeTarget">Target</label>
                    <input type="text" class="form-control w-100" id="fieldEdgeTarget" placeholder="the 'id' for target">
                  </div>
                </div>
              </div>

              <!-- Add blank space to form -->
              <pre></pre> 
              <div class="form-group" id="fieldNodeDivGroup">
                <h3><label for="dynamicNodeDataFields">Data Tag(s):</label></h3>
                <div class="dynamicNodeDataFields">
                  <!-- Source: https://www.codexworld.com/add-remove-input-fields-dynamically-using-jquery/ -->
                  <div>
                    <label for="fieldNodeKeyVal[]">Key</label>
                    <input type="text" name="fieldNodeKeyVal[]" value=""/>
                    <label for="fieldNodeDataVal[]">Value</label>
                    <input type="text" name="fieldNodeDataVal[]" value=""/>
                      <a href="javascript:void(0);" class="add_button" title="Add field"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-plus" viewBox="0 0 16 16">
                        <path d="M8.5 6a.5.5 0 0 0-1 0v1.5H6a.5.5 0 0 0 0 1h1.5V10a.5.5 0 0 0 1 0V8.5H10a.5.5 0 0 0 0-1H8.5V6z"/>
                        <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"/>
                      </svg></a>
                  </div>
                </div>
              
                <!-- <label for="nodeValue">Node Value</label>
                <input type="text" class="form-control" id="nodeValue" placeholder="Enter node value"><br>
  
                <label for="nodeText">Node Text</label>
                <input type="text" class="form-control" id="nodeText" placeholder="Enter node text"><br>   -->
              </div>  

              <!-- SHOW or HIDE Type Selection in Div tags -->
              <script type="text/javascript">//<![CDATA[
                $("#graphElementType").change(function() {
                  if ($(this).val() == "edge") {
                    $('#fieldEdgeDivGroup').show();
                    $('#fieldNodeDivGroup').hide();

                  } else {
                    $('#fieldEdgeDivGroup').hide();
                    $('#fieldNodeDivGroup').show();
                  }
                });
                $("#graphElementType").trigger("change");
              //]]></script>

            </div>
          </div>
        </div>

      </div>
    </div>
  </div> 
<br><br>
  <button onclick="addTextToScratchPad()">Add Text to Scratch Pad</button>
  <hr>

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h2> Current Node String</h2>
      </div>
      <div>
      <!--JavaScript will generate the string and render it here-->
      <div id="currentNodeString"></div>
      </div>
    </div>
  </div>

  <!-- <hr>
  <h2>DEMO: add/remove fields dynamically</h1>


              HOWTO dynamic, manual form expansion... -->


              <!-- HOWTO dynamic, manual form expansion... -->

<script type="text/javascript">
//Source: https://www.codexworld.com/add-remove-input-fields-dynamically-using-jquery/
$(document).ready(function(){
    var maxField = 10; //Input fields increment limitation
    var addButton = $('.add_button'); //Add button selector
    var wrapper = $('.dynamicNodeDataFields'); //Input field wrapper
    var fieldHTML = '<div> \
                       <label for="fieldNodeKeyVal[]">Key</label>\
                       <input type="text" name="fieldNodeKeyVal[]" value=""/>\
                       <label for="fieldNodeDataVal[]">Value</label>\
                      <input type="text" name="fieldNodeDataVal[]" value=""/>\
                       <a href="javascript:void(0);" class="remove_button"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-file-minus\" viewBox=\"0 0 16 16\"><path d=\"M5.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1-.5-.5z\"/><path d=\"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z\"/></svg></a>\
                       </div>'; //New input field html 
    var x = 1; //Initial field counter is 1
    
    //Once add button is clicked
    $(addButton).click(function(){
        //Check maximum number of input fields
        if(x < maxField){ 
            x++; //Increment field counter
            $(wrapper).append(fieldHTML); //Add field html
        }
    });
    
    //Once remove button is clicked
    $(wrapper).on('click', '.remove_button', function(e){
        e.preventDefault();
        $(this).parent('div').remove(); //Remove field html
        x--; //Decrement field counter
    });
});
</script>

    <hr>
      <h1>Scratch Pad</h1>
      <p id="ScratchPad"></p>
    <hr>

  </body>
</html>

<!-- 
  Example Key:
    <key attr.name="name" attr.type="string" for="node" id="nameNode"><default>NaN</default></key>

  Example Node:
    <node id="boss_04_Diablo"> 
      <data key="nameNode">Diablo</data>
      <data key="idLinkNode">0</data>
      <data key="descriptionNode"><![CDATA[
        <ul style="list-style-type:disc">
          <li>Prime Evil: Lord of Terror</li>
          <li>Spent 2 centuries to corrupt the Soulstone that imprisoned him.</li>
          <li>Corrupted both King Leoric and his archbishop, Lazarus</li>
          <li>The King proved too strong to fully control, so the Demon took possession of his son, Prince Albrecht.</li>
          <li>Shaped an outpost of Hell within the catacombs that ran beneath the town of Tristram</li>
          <li>The will of Diablo fully influenced this adventurer (The Dark Wanderer), and he believed that the only way to fully control the Demon was to plunge the shard of the Soulstone into his own head.</li>
        </ul>

        <p>Source: http://classic.battle.net/diablo2exp/monsters/act4-diablo.shtml</p>
        ]]></data>
    </node>
  
    <node id="npc_D1_DarkWander">
      <data key="nameNode">Dark Wanderer</data>
      <data key="idLinkNode">1</data>
    </node>


  Example Edge:
    <edge id="Link Dark Wanderer to Diablo" source="1" target="0"/>

-->